import{_ as xe,r as d,u as Me,q as Te,m as C,s as qe,i as r,o as v,j as _,k as s,l as o,x as Oe,y as a,d as F,e as f,c as le,f as Ne,F as oe,t as Pe,z as Ee,a as Ae}from"./app-dea674a6.js";import{u as Le,c as $e,a as m,b as X,d as Be,e as te,g as u}from"./index.esm-6efb83c4.js";const Fe={__name:"InventoryProduct",setup(Ge){const R=d(!1),G=d(""),j=d("success"),z=d(!1),ne=Me(),J=d(ne.params.gtin),Q=["MINIFIG","PART","SET","BOOK","GEAR","CATALOG","INSTRUCTION","UNSORTED_LOT","ORIGINAL_BOX"],se=["Complete","Incomplete","Sealed"],{handleSubmit:re}=Le({validationSchema:$e({title:m().required(),item_no:m().required(),item_type:m().oneOf(Q).required(),color_id:X().required(),quantity:X().required().integer(),price:m().required(),condition:m().oneOf(["new","used"]).required(),completeness:m().nullable(),category_id:Be().of(X()).min(1,"Please select at least one category."),gtin:m().nullable(),sku:m().nullable(),retain:te().required(),is_stock_room:te().required(),stock_room_id:m().nullable()})}),S=u("title"),x=u("item_no"),V=u("item_type"),M=u("color_id"),T=u("quantity"),q=u("price"),O=u("condition"),N=u("completeness"),D=u("category_id"),b=u("gtin"),P=u("sku"),E=u("retain"),k=u("is_stock_room"),I=u("stock_room_id"),p=u("imageurl"),y=u("gallery"),A=d([]);Te(A,n=>{D.value.value=n.map(e=>e.id)});const W=d([]),K=d([]),L=d([]),ue=d(!1),U=d(null),w=d(""),H=d("https://portal.bntk.eu/image-placeholder.png"),ie=async()=>{const n=await C.get("/api/generate-ean");b.value.value=n.data},de=n=>{var i;const e=(i=n.target.files)==null?void 0:i[0];e&&(w.value=URL.createObjectURL(e))},ve=()=>{w.value=H.value,U.value=null},me=n=>{for(const e of n.target.files||[])L.value.push(URL.createObjectURL(e))},ce=n=>L.value.splice(n,1),pe=n=>{const e=document.createElement("a");e.href=n,e.download="",e.click()},ge=re(async n=>{try{z.value=!0;const e=new FormData;if(e.append("title",n.title),e.append("item_no",n.item_no),e.append("item_type",n.item_type),e.append("color_id",n.color_id),e.append("quantity",n.quantity),e.append("price",n.price),e.append("condition",n.condition),e.append("completeness",n.completeness||""),n.category_id.forEach((t,g)=>{e.append(`category_id[${g}]`,t)}),e.append("gtin",n.gtin||""),e.append("sku",n.sku||""),e.append("retain",E.value.value?1:0),e.append("is_stock_room",k.value.value?1:0),e.append("stock_room_id",I.value.value||""),e.append("imageurl",p.value.value||""),U.value&&e.append("mainImage",U.value),y.value.value&&y.value.value.length)for(let t=0;t<y.value.value.length;t++)e.append("gallery[]",y.value.value[t]);const i=await C.post(`/api/product/${J.value}`,e,{headers:{"Content-Type":"multipart/form-data"}});G.value=i.data.message||"Product successfully Edited!",j.value="success",R.value=!0,console.log("Saved:",i.data)}catch(e){G.value=res.data.message||"Failed to add product.",j.value="error",R.value=!0,console.error("Error while submitting:",e)}finally{z.value=!1}});return qe(async()=>{const[n,e,i]=await Promise.all([C.get("/api/colors"),C.get("/api/categorylist"),C.get(`/api/product/${J.value}`)]);W.value=n.data,K.value=e.data;const t=i.data,g=Array.isArray(t.category_id)?t.category_id:typeof t.category_id=="string"?t.category_id.split(",").map(c=>parseInt(c.trim())):[];D.value.value=g,A.value=K.value.filter(c=>g.includes(c.id)),S.value.value=t.title,x.value.value=t.item_no,V.value.value=t.item_type,M.value.value=t.color_id,T.value.value=t.stock,q.value.value=t.price,O.value.value=t.condition,N.value.value=t.completeness,b.value.value=t.gtin,P.value.value=t.sku,E.value.value=!!t.retain,k.value.value=t.is_stock_room==1,I.value.value=t.stock_room_id,p.value.value=t.imageurl,w.value=t.main_image||H.value,L.value=t.gallery_images||[]}),(n,e)=>{const i=r("v-text-field"),t=r("v-select"),g=r("v-autocomplete"),c=r("v-btn"),Y=r("v-switch"),$=r("v-img"),B=r("v-icon"),Z=r("v-file-input"),h=r("v-col"),ee=r("v-row"),_e=r("v-fade-transition"),fe=r("v-hover"),ye=r("v-form"),Ve=r("v-card-text"),be=r("v-card"),ke=r("v-progress-circular"),Ie=r("v-overlay"),Ue=r("v-snackbar"),we=r("v-container");return v(),_(we,{fluid:""},{default:s(()=>[o(be,{class:"card z-index-2 h-100"},{default:s(()=>[o(Ve,{class:"card-body p-3"},{default:s(()=>[o(ye,{onSubmit:Oe(a(ge),["prevent"])},{default:s(()=>[o(i,{modelValue:a(S).value.value,"onUpdate:modelValue":e[0]||(e[0]=l=>a(S).value.value=l),label:"Titel",variant:"outlined","error-messages":a(S).errorMessage.value},null,8,["modelValue","error-messages"]),o(i,{modelValue:a(x).value.value,"onUpdate:modelValue":e[1]||(e[1]=l=>a(x).value.value=l),label:"Item No",variant:"outlined","error-messages":a(x).errorMessage.value},null,8,["modelValue","error-messages"]),o(t,{modelValue:a(V).value.value,"onUpdate:modelValue":e[2]||(e[2]=l=>a(V).value.value=l),items:Q,label:"Item Type",variant:"outlined","error-messages":a(V).errorMessage.value},null,8,["modelValue","error-messages"]),a(V).value.value==="SET"?(v(),_(t,{key:0,modelValue:a(N).value.value,"onUpdate:modelValue":e[3]||(e[3]=l=>a(N).value.value=l),items:se,label:"Completeness",variant:"outlined","error-messages":a(N).errorMessage.value},null,8,["modelValue","error-messages"])):F("",!0),o(g,{modelValue:a(M).value.value,"onUpdate:modelValue":e[4]||(e[4]=l=>a(M).value.value=l),items:W.value,"item-title":"bricklink_name","item-value":"bricklink_id",label:"Color",variant:"outlined","error-messages":a(M).errorMessage.value},null,8,["modelValue","items","error-messages"]),o(i,{modelValue:a(T).value.value,"onUpdate:modelValue":e[5]||(e[5]=l=>a(T).value.value=l),label:"Stock",variant:"outlined","error-messages":a(T).errorMessage.value},null,8,["modelValue","error-messages"]),o(i,{modelValue:a(q).value.value,"onUpdate:modelValue":e[6]||(e[6]=l=>a(q).value.value=l),label:"Prijs",variant:"outlined","error-messages":a(q).errorMessage.value},null,8,["modelValue","error-messages"]),o(t,{modelValue:a(O).value.value,"onUpdate:modelValue":e[7]||(e[7]=l=>a(O).value.value=l),items:["new","used"],label:"Condition",variant:"outlined","error-messages":a(O).errorMessage.value},null,8,["modelValue","error-messages"]),o(g,{modelValue:A.value,"onUpdate:modelValue":e[8]||(e[8]=l=>A.value=l),items:K.value,"item-title":"title","item-value":"id",label:"CategorieÃ«n",multiple:"",chips:"","return-object":"",variant:"outlined","error-messages":a(D).errorMessage.value},null,8,["modelValue","items","error-messages"]),o(i,{modelValue:a(b).value.value,"onUpdate:modelValue":e[9]||(e[9]=l=>a(b).value.value=l),label:"EAN (GTIN)",variant:"outlined","error-messages":a(b).errorMessage.value},{"append-inner":s(()=>[o(c,{onClick:ie},{default:s(()=>e[18]||(e[18]=[f("Genereer")])),_:1,__:[18]})]),_:1},8,["modelValue","error-messages"]),o(i,{modelValue:a(P).value.value,"onUpdate:modelValue":e[10]||(e[10]=l=>a(P).value.value=l),label:"SKU",variant:"outlined","error-messages":a(P).errorMessage.value},null,8,["modelValue","error-messages"]),o(Y,{modelValue:a(E).value.value,"onUpdate:modelValue":e[11]||(e[11]=l=>a(E).value.value=l),label:"Retain",variant:"outlined",color:"success"},null,8,["modelValue"]),o(Y,{modelValue:a(k).value.value,"onUpdate:modelValue":e[12]||(e[12]=l=>a(k).value.value=l),label:"Is Stock Room?",variant:"outlined",color:"success"},null,8,["modelValue"]),a(k).value.value?(v(),_(t,{key:1,modelValue:a(I).value.value,"onUpdate:modelValue":e[13]||(e[13]=l=>a(I).value.value=l),items:["A","B","C"],label:"Stock Room ID",variant:"outlined","error-messages":a(I).errorMessage.value},null,8,["modelValue","error-messages"])):F("",!0),o(i,{modelValue:a(p).value.value,"onUpdate:modelValue":e[14]||(e[14]=l=>a(p).value.value=l),label:"Afbeelding URL",variant:"outlined","error-messages":a(p).errorMessage.value},null,8,["modelValue","error-messages"]),a(p).value.value?(v(),_($,{key:2,class:"mb-5 image-size",contain:"","max-width":"250",src:a(p).value.value},null,8,["src"])):(v(),_($,{key:3,class:"mb-5 image-size",contain:"","max-width":"250",src:H.value},null,8,["src"])),o(Z,{modelValue:U.value,"onUpdate:modelValue":e[15]||(e[15]=l=>U.value=l),variant:"outlined",accept:"image/*",label:"Hoofdafbeelding",onChange:de,"onClick:clear":ve,clearable:""},{"prepend-inner":s(()=>[o(B,{class:"mr-3"},{default:s(()=>e[19]||(e[19]=[f("fa-image")])),_:1,__:[19]})]),_:1},8,["modelValue"]),w.value?(v(),_(ee,{key:4},{default:s(()=>[o(h,{class:"image-container",cols:"2"},{default:s(()=>[o($,{class:"mb-5 image-size",contain:"","max-width":"250",src:w.value},null,8,["src"])]),_:1})]),_:1})):F("",!0),o(Z,{modelValue:a(y).value.value,"onUpdate:modelValue":e[16]||(e[16]=l=>a(y).value.value=l),"loader-height":"5",loading:ue.value,multiple:"","prepend-icon":"",variant:"outlined",accept:"image/*",label:"Gallerij afbeeldingen","truncate-length":"15",onChange:me},{"prepend-inner":s(()=>[o(B,{class:"mr-3"},{default:s(()=>e[20]||(e[20]=[f("fa-image")])),_:1,__:[20]})]),_:1},8,["modelValue","loading"]),o(ee,null,{default:s(()=>[(v(!0),le(oe,null,Ne(L.value,(l,ae)=>(v(),_(h,{class:"image-container",cols:"2",key:ae},{default:s(()=>[o(fe,null,{default:s(({isHovering:Ce,props:Re})=>[o($,Ee({ref_for:!0},Re,{class:"image-size mb-5",contain:"","max-width":"250",src:l}),{default:s(()=>[Ce?(v(),le(oe,{key:0},[o(_e,null,{default:s(()=>e[21]||(e[21]=[Ae("div",{class:"overlay"},null,-1)])),_:1,__:[21]}),o(c,{icon:"",class:"delete-btn",onClick:Se=>ce(ae)},{default:s(()=>[o(B,null,{default:s(()=>e[22]||(e[22]=[f("fa-trash-can")])),_:1,__:[22]})]),_:2},1032,["onClick"]),o(c,{icon:"",class:"download-btn",onClick:Se=>pe(l)},{default:s(()=>[o(B,null,{default:s(()=>e[23]||(e[23]=[f("fa-floppy-disk")])),_:1,__:[23]})]),_:2},1032,["onClick"])],64)):F("",!0)]),_:2},1040,["src"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),o(c,{class:"btn-primary mt-4",type:"submit"},{default:s(()=>e[24]||(e[24]=[f("Opslaan")])),_:1,__:[24]})]),_:1},8,["onSubmit"])]),_:1})]),_:1}),o(Ie,{"model-value":z.value,persistent:"",class:"d-flex align-center justify-center"},{default:s(()=>[o(ke,{size:"64",indeterminate:"",color:"primary"})]),_:1},8,["model-value"]),o(Ue,{modelValue:R.value,"onUpdate:modelValue":e[17]||(e[17]=l=>R.value=l),color:j.value,timeout:"3000",location:"top right"},{default:s(()=>[f(Pe(G.value),1)]),_:1},8,["modelValue","color"])]),_:1})}}},De=xe(Fe,[["__scopeId","data-v-fbddfee6"],["__file","InventoryProduct.vue"]]);export{De as default};
