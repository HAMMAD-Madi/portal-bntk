import{_ as X,r as s,o as c,c as h,a as t,w as oe,v as me,b as _e,d as R,e as B,t as f,F,f as O,n as fe,g as ge,h as K,i as o,j as T,k as n,l as a,m as M,u as ke,p as ye,q as j,s as be}from"./app-be4f7d6f.js";const we={class:"bulk-stock-update"},he={class:"card shadow-lg"},Ve={class:"card-body"},xe={class:"mb-3"},Ue={class:"input-group mb-3"},Ce=["disabled"],Se={key:0,class:"spinner-border spinner-border-sm me-1"},Le={class:"table-responsive"},$e={class:"table table-striped"},Pe={key:0,class:"mt-4"},Ie={class:"table-responsive"},Ne={class:"table table-sm"},Be={__name:"BulkStockUpdate",props:{selectedProducts:{type:Array,required:!0}},emits:["update-complete"],setup(q,{emit:E}){const A=q,g=E,p=s("set"),y=s(0),x=s(!1),u=s([]),U=s(""),C=s(""),w=s(!1),$=b=>{switch(p.value){case"set":return y.value;case"add":return b+y.value;case"subtract":return Math.max(0,b-y.value);default:return b}},S=async()=>{var b,d;x.value=!0;try{const i=A.selectedProducts.map(k=>({gtin:k.gtin,stock:$(k.stock)}));(await ge.post("/api/products/bulk-update-stock",{updates:i})).data.success&&(U.value="Stock levels updated successfully",C.value="success",w.value=!0,g("update-complete",!0))}catch(i){console.error("Update error:",i),U.value=((d=(b=i.response)==null?void 0:b.data)==null?void 0:d.message)||"Error updating stock levels",C.value="error",w.value=!0,g("update-complete",!1)}finally{x.value=!1}};return(b,d)=>(c(),h("div",we,[t("div",he,[d[6]||(d[6]=t("div",{class:"card-header"},[t("h4",null,"Update Stock Levels")],-1)),t("div",Ve,[t("div",xe,[d[3]||(d[3]=t("label",{class:"form-label"},"Stock Adjustment",-1)),t("div",Ue,[oe(t("select",{"onUpdate:modelValue":d[0]||(d[0]=i=>p.value=i),class:"form-select"},d[2]||(d[2]=[t("option",{value:"set"},"Set to",-1),t("option",{value:"add"},"Add",-1),t("option",{value:"subtract"},"Subtract",-1)]),512),[[me,p.value]]),oe(t("input",{type:"number",class:"form-control","onUpdate:modelValue":d[1]||(d[1]=i=>y.value=i),min:"0",placeholder:"Enter quantity"},null,512),[[_e,y.value]]),t("button",{class:"btn btn-primary",onClick:S,disabled:!q.selectedProducts.length||x.value},[x.value?(c(),h("span",Se)):R("",!0),B(" "+f(x.value?"Updating...":"Update Stock"),1)],8,Ce)])]),t("div",Le,[t("table",$e,[d[4]||(d[4]=t("thead",null,[t("tr",null,[t("th",null,"GTIN"),t("th",null,"Title"),t("th",null,"Current Stock"),t("th",null,"New Stock")])],-1)),t("tbody",null,[(c(!0),h(F,null,O(q.selectedProducts,i=>(c(),h("tr",{key:i.gtin},[t("td",null,f(i.gtin),1),t("td",null,f(i.title),1),t("td",null,f(i.stock),1),t("td",null,f($(i.stock)),1)]))),128))])])]),u.value.length?(c(),h("div",Pe,[d[5]||(d[5]=t("h5",null,"Update Results",-1)),t("div",Ie,[t("table",Ne,[t("tbody",null,[(c(!0),h(F,null,O(u.value,i=>(c(),h("tr",{key:i.gtin},[t("td",null,f(i.title),1),t("td",null,[t("span",{class:fe(["badge",i.success?"bg-success":"bg-danger"])},f(i.success?"Success":"Error"),3)]),t("td",null,f(i.message),1)]))),128))])])])])):R("",!0)])])]))}},Ee=X(Be,[["__scopeId","data-v-c07eca42"],["__file","BulkStockUpdate.vue"]]),Ae={__name:"BulkLocationUpdate",props:{modelValue:Boolean,selectedProducts:{type:Array,required:!0}},emits:["update:modelValue","updated"],setup(q,{emit:E}){const A=q,g=E,p=K({get:()=>A.modelValue,set:k=>g("update:modelValue",k)}),y=s(null),x=s(""),u=s([]),U=s(!1),C=s(""),w=s(!1),$=s(""),S=s("success"),b=()=>{p.value=!1,y.value=null,x.value="",C.value=""},d=k=>{const r=u.value.find(I=>I.id===k);return r?r.name:"No Location"},i=async()=>{try{const k=await M.get("/api/stock-locations");u.value=k.data}catch(k){console.error("Error loading locations:",k),$.value="Error loading locations",S.value="error",w.value=!0}},P=async()=>{var k,r;if(!y.value){C.value="Please select a location";return}U.value=!0;try{await M.post("/api/products/bulk-update-location",{product_ids:A.selectedProducts.map(I=>I.id),location_id:y.value,shelf_position:x.value||null}),$.value="Locations updated successfully",S.value="success",w.value=!0,g("updated"),b()}catch(I){console.error("Error updating locations:",I),$.value=((r=(k=I.response)==null?void 0:k.data)==null?void 0:r.message)||"Error updating locations",S.value="error",w.value=!0}finally{U.value=!1}};return i(),(k,r)=>{const I=o("v-card-title"),G=o("v-select"),Q=o("v-col"),W=o("v-row"),L=o("v-table"),Z=o("v-card-text"),H=o("v-spacer"),l=o("v-btn"),e=o("v-card-actions"),m=o("v-snackbar"),N=o("v-card"),z=o("v-dialog");return c(),T(z,{modelValue:p.value,"onUpdate:modelValue":r[2]||(r[2]=V=>p.value=V),"max-width":"600"},{default:n(()=>[a(N,null,{default:n(()=>[a(I,null,{default:n(()=>r[3]||(r[3]=[B("Update Stock Locations")])),_:1,__:[3]}),a(Z,null,{default:n(()=>[a(W,null,{default:n(()=>[a(Q,{cols:"12"},{default:n(()=>[a(G,{modelValue:y.value,"onUpdate:modelValue":r[0]||(r[0]=V=>y.value=V),items:u.value,"item-title":"name","item-value":"id",label:"Location",variant:"outlined","error-messages":C.value},null,8,["modelValue","items","error-messages"])]),_:1})]),_:1}),a(L,null,{default:n(()=>[r[4]||(r[4]=t("thead",null,[t("tr",null,[t("th",null,"GTIN"),t("th",null,"Title"),t("th",null,"Current Location")])],-1)),t("tbody",null,[(c(!0),h(F,null,O(q.selectedProducts,V=>(c(),h("tr",{key:V.id},[t("td",null,f(V.gtin),1),t("td",null,f(V.title),1),t("td",null,f(d(V.location_id)),1)]))),128))])]),_:1,__:[4]})]),_:1}),a(e,null,{default:n(()=>[a(H),a(l,{color:"grey-darken-1",variant:"text",onClick:b},{default:n(()=>r[5]||(r[5]=[B(" Cancel ")])),_:1,__:[5]}),a(l,{color:"primary",loading:U.value,disabled:!y.value,onClick:P},{default:n(()=>r[6]||(r[6]=[B(" Update Locations ")])),_:1,__:[6]},8,["loading","disabled"])]),_:1}),a(m,{modelValue:w.value,"onUpdate:modelValue":r[1]||(r[1]=V=>w.value=V),color:S.value,timeout:"3000"},{default:n(()=>[B(f($.value),1)]),_:1},8,["modelValue","color"])]),_:1})]),_:1},8,["modelValue"])}}},je=X(Ae,[["__file","BulkLocationUpdate.vue"]]);const Te={class:"d-flex align-center mb-5 gap-4"},qe={class:"d-flex align-center mb-3"},Me={class:"product-info-container"},ze={class:"product-info"},Re={class:"product-info"},De={class:"product-info"},Fe={class:"bruh",style:{display:"flex","justify-content":"center",gap:"50px"}},Ge={class:"my-5",style:{display:"flex","justify-content":"center"}},Oe={key:0},Qe={key:1},We={style:{display:"flex","justify-content":"center"}},Ze={__name:"InventoryIndex",setup(q){const E=s(""),A=s(""),g=s([]),p=s(1),y=s(12),x=s(),u=s([]),U=s(!1),C=s(!1),w=s(null),$=s([]),S=s(null),b=s(null),d=s([]),i=s([{title:"New",value:"new"},{title:"Used",value:"used"}]),P=s(!1),k=K(()=>Math.ceil(x.value/y.value));ke(),ye();const r=async l=>{l&&(U.value=!1,u.value=[],await L(p.value))},I=async()=>{C.value=!1,u.value=[],await L(p.value)},G=async(l,e)=>{const m=g.value.findIndex(N=>l.id==N.id);e=="plus"?(await M.post("/api/product/quantity",{id:l.raw.id,operation:e}),l.raw.stock+=1,g.value[m]=l):e=="minus"&&l.raw.stock>0&&(l.raw.stock-=1,g.value[m]=l,await M.post("/api/product/quantity",{id:l.raw.id,operation:e}))};j(p,l=>{L(l)}),j(E,()=>{L(1)}),j(A,()=>{p.value=1,L(1)}),j(w,()=>{p.value=1,L(1)}),j(S,()=>{p.value=1,L(1)}),j(b,()=>{p.value=1,L(1)});const Q=async()=>{try{const l=await M.get("/api/colors"),e=new Map;l.data.forEach(m=>{e.has(m.bricklink_id)||e.set(m.bricklink_id,{bricklink_id:m.bricklink_id,bricklink_name:m.bricklink_name})}),$.value=Array.from(e.values())}catch(l){console.error("Error loading colors:",l)}},W=async()=>{try{const l=await M.get("/api/categorylist");if(!l.data||!Array.isArray(l.data)){console.error("Invalid categories data:",l.data);return}const e=new Map;l.data.forEach(m=>{e.has(m.id)||e.set(m.id,{id:m.id,title:m.title})}),d.value=Array.from(e.values())}catch(l){console.error("Error fetching categories:",l)}},L=async(l=1)=>{const e=await M.get("/api/product",{params:{page:l,search:E.value,item_no:A.value,color:w.value,category:S.value,condition:b.value}});x.value=e.data.total,g.value=e.data.data};be(async()=>{await Q(),await W(),L(1)});const Z=l=>Number(l).toLocaleString("nl-NL",{style:"currency",currency:"EUR"}),H=()=>{if(console.log(P.value),P.value){console.log("products.value",g.value);const l=g.value.map(e=>e);u.value=l,console.log(u)}else u.value=[]};return K(()=>u.value.length===g.value.length),j(u,l=>{const e=g.value.map(N=>N.raw),m=e.every(N=>l.some(z=>z.id===N.id));P.value=m&&e.length>0},{deep:!0}),j(u,l=>{P.value=l.length===g.value.length&&l.length>0},{deep:!0}),j(g,()=>{P.value=!1,u.value=[]}),(l,e)=>{const m=o("router-view"),N=o("v-text-field"),z=o("v-autocomplete"),V=o("v-select"),Y=o("v-checkbox"),se=o("v-spacer"),D=o("v-btn"),ee=o("v-img"),ne=o("v-card-title"),te=o("v-icon"),ue=o("vue-barcode"),le=o("v-card-text"),ae=o("v-card"),ie=o("v-col"),de=o("v-row"),re=o("v-pagination"),ce=o("v-data-iterator"),ve=o("v-dialog"),pe=o("v-container");return c(),h(F,null,[a(m),a(pe,{fluid:""},{default:n(()=>[a(ae,{class:"card z-index-2 h-100"},{default:n(()=>[a(le,{class:"card-body p-3"},{default:n(()=>[t("div",Te,[a(N,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=v=>E.value=v),"prepend-inner-icon":"fas fa-magnifying-glass",label:"Zoeken","single-line":"",variant:"outlined","hide-details":"",class:"flex-grow-1",clearable:""},null,8,["modelValue"]),a(N,{modelValue:A.value,"onUpdate:modelValue":e[1]||(e[1]=v=>A.value=v),label:"Item No",variant:"outlined","hide-details":"",clearable:"",style:{"min-width":"150px"}},null,8,["modelValue"]),a(z,{modelValue:S.value,"onUpdate:modelValue":e[2]||(e[2]=v=>S.value=v),items:d.value,"item-value":"id","item-title":"title",label:"Category",variant:"outlined","hide-details":"",class:"flex-shrink-0",style:{"min-width":"200px"},clearable:"","return-object":""},null,8,["modelValue","items"]),a(z,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=v=>w.value=v),items:$.value,"item-value":"bricklink_id","item-title":"bricklink_name",label:"Color",variant:"outlined","hide-details":"",class:"flex-shrink-0",style:{"min-width":"180px"},clearable:"","return-object":""},null,8,["modelValue","items"]),a(V,{modelValue:b.value,"onUpdate:modelValue":e[4]||(e[4]=v=>b.value=v),items:i.value,label:"Condition",variant:"outlined","hide-details":"",class:"flex-shrink-0",style:{"min-width":"150px"},clearable:""},null,8,["modelValue","items"])]),t("div",qe,[a(Y,{modelValue:P.value,"onUpdate:modelValue":e[5]||(e[5]=v=>P.value=v),label:"Select All Items","hide-details":"",onChange:H},null,8,["modelValue"]),a(se),u.value.length?(c(),T(D,{key:0,class:"btn-primary",onClick:e[6]||(e[6]=v=>U.value=!0)},{default:n(()=>[B(" Update Stock ("+f(u.value.length)+") ",1)]),_:1})):R("",!0),u.value.length?(c(),T(D,{key:1,class:"btn-secondary ms-2",onClick:e[7]||(e[7]=v=>C.value=!0)},{default:n(()=>[B(" Update Locations ("+f(u.value.length)+") ",1)]),_:1})):R("",!0)]),a(ce,{"onUpdate:options":l.updateOptions,search:E.value,page:p.value,"items-per-page":y.value,items:g.value},{default:n(({items:v})=>[a(de,{align:"start"},{default:n(()=>[(c(!0),h(F,null,O(v,_=>(c(),T(ie,{cols:"12",md:"6",lg:"4",xl:"3",key:_.id},{default:n(()=>[a(ae,null,{default:n(()=>[a(Y,{modelValue:u.value,"onUpdate:modelValue":e[8]||(e[8]=J=>u.value=J),value:_.raw,class:"ma-2","hide-details":""},null,8,["modelValue","value"]),_.raw.imageurl?(c(),T(ee,{key:0,height:"200",src:`${_.raw.imageurl}`,class:"text-white"},null,8,["src"])):(c(),T(ee,{key:1,height:"200",src:`https://portal.bntk.eu${_.raw.main_image}`,class:"text-white"},null,8,["src"])),a(ne,null,{default:n(()=>[B(f(_.raw.title),1)]),_:2},1024),a(le,null,{default:n(()=>[t("div",Me,[e[12]||(e[12]=t("div",{class:"product-info"},"Voorraad:",-1)),t("div",ze,f(_.raw.stock),1),e[13]||(e[13]=t("div",{class:"product-info"},"Prijs",-1)),t("div",Re,f(Z(_.raw.price)),1),e[14]||(e[14]=t("div",{class:"product-info"},"Condition:",-1)),t("div",De,f(_.raw.condition),1)]),t("div",Fe,[_.raw.is_trashed?R("",!0):(c(),T(D,{key:0,onClick:J=>G(_,"minus"),class:"btn-info",size:"small",icon:""},{default:n(()=>[a(te,null,{default:n(()=>e[15]||(e[15]=[B("fa-minus")])),_:1,__:[15]})]),_:2},1032,["onClick"])),_.raw.is_trashed?R("",!0):(c(),T(D,{key:1,onClick:J=>G(_,"plus"),class:"btn-info",size:"small",icon:""},{default:n(()=>[a(te,null,{default:n(()=>e[16]||(e[16]=[B("fa-plus")])),_:1,__:[16]})]),_:2},1032,["onClick"]))]),t("div",Ge,[a(D,{to:`/voorraad/${_.raw.id}`,class:"btn-primary w-100 mt-4 mb-0"},{default:n(()=>[_.raw.is_trashed?(c(),h("span",Qe,"Product herstellen")):(c(),h("span",Oe,"Wijzigen"))]),_:2},1032,["to"])]),t("div",We,[a(ue,{value:_.raw.gtin,options:{displayValue:!0,height:50}},null,8,["value"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024),a(re,{modelValue:p.value,"onUpdate:modelValue":e[9]||(e[9]=_=>p.value=_),length:k.value,"total-visible":7},null,8,["modelValue","length"])]),_:1},8,["onUpdate:options","search","page","items-per-page","items"]),a(ve,{modelValue:U.value,"onUpdate:modelValue":e[10]||(e[10]=v=>U.value=v),"max-width":"600px"},{default:n(()=>[a(Ee,{"selected-products":u.value,onUpdateComplete:r},null,8,["selected-products"])]),_:1},8,["modelValue"]),a(je,{modelValue:C.value,"onUpdate:modelValue":e[11]||(e[11]=v=>C.value=v),"selected-products":u.value,onUpdated:I},null,8,["modelValue","selected-products"])]),_:1})]),_:1})]),_:1})],64)}}},Je=X(Ze,[["__scopeId","data-v-3fa9cc94"],["__file","InventoryIndex.vue"]]);export{Je as default};
